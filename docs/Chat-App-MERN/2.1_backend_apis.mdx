---
title: "Backend APIs"
description: "Documentation of the various RESTful APIs exposed by the backend."
---

# Backend APIs

<TOC />

## Authentication APIs (`/auth`)

This section details the APIs related to user authentication and profile management.  These APIs utilize Passport.js for authentication strategies.  The `protectRoute` middleware ensures that certain routes are only accessible to authenticated users.  [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/backend/src/routes/auth.route.js)

### User Signup (`/auth/signup`)

*   **Method:** `POST`
*   **Endpoint:** `/auth/signup`
*   **Description:** Registers a new user.  The request body should contain user credentials (likely username, password, and potentially email).  The `signup` controller handles user creation and data persistence.
*   **Response:** On success, returns a success message and potentially a JWT (JSON Web Token) for authentication. On failure, returns an error message (e.g., username already exists).


### User Login (`/auth/login`)

*   **Method:** `POST`
*   **Endpoint:** `/auth/login`
*   **Description:** Authenticates an existing user. The request body should contain the user's credentials. The `login` controller verifies the credentials against the database and issues a JWT upon successful authentication.
*   **Response:** On success, returns a JWT.  On failure, returns an error message.


### User Logout (`/auth/logout`)

*   **Method:** `POST`
*   **Endpoint:** `/auth/logout`
*   **Description:** Logs out the current user, invalidating their session.
*   **Response:** Returns a success message.


### Update User Profile (`/auth/update-profile`)

*   **Method:** `PUT`
*   **Endpoint:** `/auth/update-profile`
*   **Description:** Allows authenticated users to update their profile information.  `protectRoute` middleware ensures only authenticated users can access this endpoint. The `updateProfile` controller handles the update logic and data validation.
*   **Response:**  Returns a success message on successful update; otherwise, an appropriate error message.


### Check Username Availability (`/auth/username/check/:username`)

*   **Method:** `GET`
*   **Endpoint:** `/auth/username/check/:username`
*   **Description:** Checks if a given username is already taken.  This API is used for real-time username availability checks during the signup process.
*   **Response:** Returns a boolean value indicating whether the username is available.


### Google Authentication (`/auth/google` and `/auth/google/callback`)

*   **Method:** `GET`
*   **Endpoint:** `/auth/google` (Initiates Google OAuth flow) and `/auth/google/callback` (Handles Google OAuth callback).
*   **Description:** This implements Google OAuth 2.0 for user authentication. The `/auth/google` endpoint redirects the user to the Google OAuth consent screen. After user authentication on the Google side, the `/auth/google/callback` endpoint receives the authorization code, exchanges it for tokens and completes the authentication process.
*   **Response:** On success, redirects the user to the frontend (possibly with JWT in URL or cookie).  On failure, redirects to the login page with an error message.

```javascript
router.get(
    '/google',
    passport.authenticate('google', { scope: ['profile', 'email'] })
);
router.get(
    '/google/callback',
    passport.authenticate('google', {
        failureRedirect: 'http://localhost:5173/login', 
        failureMessage: true 
    }),
    googleAuthCallback 
);
```

This code snippet shows how Google OAuth is integrated using Passport.js. The first route initiates the authentication flow, and the second handles the callback. `failureRedirect` and `failureMessage` handle authentication failures.


````mermaid
graph TD
    A[User] --> B{Signup or Login};
    B -- Signup --> C[Signup API];
    B -- Login --> D[Login API];
    C --> E[Database];
    D --> E;
    E -- Success --> F[JWT];
    E -- Failure --> G[Error];
    F --> A;
    G --> A;
    A --> H[Google OAuth];
    H --> I[Google];
    I --> J[Google Callback];
    J --> F;
```


## Friend Management APIs (`/friend`)

This section describes the APIs for managing friend requests and relationships. All routes within this section require authentication (`protectRoute`). [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/backend/src/routes/friend.route.js)

```javascript
router.use(protectRoute);

router.post("/request/send/", sendFriendRequest);
router.post("/request/accept/:senderId", acceptFriendRequest);
router.post("/request/reject/:senderId", rejectFriendRequest);
router.delete("/remove/:friendId", removeFriend);
router.get("/list", getFriends);
router.get("/requests/pending", getPendingRequests);
router.get("/requests/sent", getSentRequests);
```

This snippet showcases the middleware `protectRoute` applied to all friend management endpoints, ensuring only authenticated users can access these functionalities.


### Friend Request Flow

````mermaid
sequenceDiagram
    participant U as User
    participant F as Friend
    participant S as Server
    U->>S: Send Friend Request
    activate S
    S->>F: Notification of Friend Request
    S-->>U: Request Sent
    deactivate S
    F->>S: Accept/Reject Friend Request
    activate S
    S->>U: Update Friendship Status
    S->>F: Update Friendship Status
    deactivate S
```

## Messaging APIs (`/message`)

This section covers the APIs for sending and retrieving messages.  Authentication is required for all endpoints. [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/backend/src/routes/message.route.js)

### Retrieving Users for Sidebar (`/message/users`)

*   **Method:** `GET`
*   **Endpoint:** `/message/users`
*   **Description:** Retrieves a list of users available for messaging.  Likely filtered based on the current user's friend list.
*   **Response:** An array of user objects (possibly only containing IDs and usernames).


### Retrieving Messages (`/message/:id`)

*   **Method:** `GET`
*   **Endpoint:** `/message/:id`  (where `:id` is the recipient's user ID)
*   **Description:** Retrieves the conversation between the authenticated user and the specified user.
*   **Response:** An array of message objects, each containing sender ID, recipient ID, message content, and timestamp.


### Sending a Message (`/message/send/:id`)

*   **Method:** `POST`
*   **Endpoint:** `/message/send/:id` (where `:id` is the recipient's user ID)
*   **Description:** Sends a message from the authenticated user to the specified user. The request body likely contains the message content.
*   **Response:**  A success or error message.

```javascript
router.get("/users", protectRoute, getUsersForSidebar);
router.get("/:id", protectRoute, getMessages);
router.post("/send/:id", protectRoute, sendMessage);
```
This snippet shows the three main message-related endpoints, all protected by `protectRoute`.


````mermaid
graph TD
    A[User] --> B(sendMessage);
    B --> C[message.controller.js];
    C --> D{Database};
    D -- Success --> E[Response];
    D -- Failure --> F[Error];
    E --> A;
    F --> A;
    G[User] --> H(getMessages);
    H --> I[message.controller.js];
    I --> D;
```

Next: [Backend Data Models](./2.2_backend_data_models.mdx)