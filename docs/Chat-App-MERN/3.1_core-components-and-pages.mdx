---
title: "Core Components and Pages"
description: "Detailed explanation of key UI components and application pages, including chat, authentication, and profile."
sidebar_position: 31
---

---
title: "Core Components and Pages"
description: "Detailed explanation of key UI components and application pages, including chat, authentication, and profile."
sidebar_position: 31
---

# Core Components and Pages
<TOC />

This section details the primary UI components and pages that form the backbone of the ShinyChat frontend. We'll explore their individual responsibilities, how they interact, and their integration with the application's state management.

## `HomePage.jsx` - The Application Layout
The `HomePage.jsx` component serves as the main layout for the ShinyChat application. It orchestrates the arrangement of the sidebar, the chat area, and supplementary components like the `FriendsBox`. This page is responsible for conditionally rendering different parts of the UI based on user interactions and application state.

### Purpose and Features
*   **Main Layout**: Provides the foundational structure for the entire chat interface.
*   **Conditional Rendering**: Dynamically displays either the `ChatContainer` (when a user is selected) or a `NoChatSelected` placeholder (when no user is selected).
*   **FriendsBox Integration**: Manages the visibility of the `FriendsBox` component, typically for mobile views or friend management.

### Key Snippet: Conditional Rendering Logic
The core logic for displaying the chat interface or a placeholder is handled by `HomePage`:

```jsx
// frontend/src/pages/HomePage.jsx
import ChatContainer from "../components/ChatContainer";
import NoChatSelected from "../components/NoChatSelected";
import Sidebar from "../components/Sidebar";
import FriendsBox from "../components/FriendsBox"; // Assuming FriendsBox for managing friend requests/search
import { useChatStore } from "../store/useChatStore"

const HomePage = () => {
  const { selectedUser, isFriendsBoxOpen } = useChatStore();

  return (
    <div className="h-screen bg-base-200">
      <div className="flex items-center justify-center pt-20 px-4 w-full">
        <div className="bg-base-100 rounded-lg shadow-xl w-full max-w-6xl h-[calc(100vh-8rem)]">
          <div className="flex h-full rounded-lg overflow-hidden w-full">
            <Sidebar />
            {/* Conditionally render ChatContainer or NoChatSelected */}
            {!selectedUser ? <NoChatSelected /> : <ChatContainer />}
            {/* Conditionally render FriendsBox, likely for pop-up or mobile */}
            {isFriendsBoxOpen && <FriendsBox />}
          </div>
        </div>
      </div>
    </div>
  )
}

export default HomePage;
```
[View on GitHub](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/pages/HomePage.jsx#L10-L26)

This snippet illustrates how `selectedUser` from `useChatStore` dictates whether the chat interface is active. The `isFriendsBoxOpen` state similarly controls the display of the `FriendsBox`.

## `Sidebar.jsx` - Friends List and User Selection
The `Sidebar` component displays a dynamic list of friends or available users, allowing the authenticated user to select a chat partner. It integrates with the chat store to fetch user data and manage the currently selected user.

### Purpose and Features
*   **User Listing**: Fetches and displays a list of users/friends.
*   **User Selection**: Allows users to select a chat partner, updating the `selectedUser` state in `useChatStore`.
*   **Online Status**: Visually indicates which users are currently online using data from `useAuthStore`.
*   **Online Filter**: Provides a checkbox to filter the list to show only online users.
*   **Responsive Display**: Adapts its visibility based on `selectedUser` for improved mobile experience.

### Key Snippet: User Rendering and Online Status
The `Sidebar` component iterates through `filteredUsers` to render each friend, applying conditional styling for online status and selection.

```jsx
// frontend/src/components/Sidebar.jsx
import { useEffect, useState } from "react";
import { useChatStore } from "../store/useChatStore";
import { useAuthStore } from "../store/useAuthStore";

const Sidebar = () => {
    const { getFriends, users, selectedUser, setSelectedUser, isUsersLoading } = useChatStore();
    const { onlineUsers } = useAuthStore();
    const [showOnlineOnly, setShowOnlineOnly] = useState(false);

    useEffect(() => {
        getFriends(); // Fetch friends when component mounts
    }, [getFriends]);

    // Filter users based on 'showOnlineOnly' state
    const filteredUsers = showOnlineOnly
        ? users.filter((user) => onlineUsers.includes(user._id))
        : users;

    if (isUsersLoading) return <SidebarSkeleton />; // Show skeleton while loading

    return (
        <div className={`h-full sm:w-72 ... ${selectedUser ? "hidden sm:flex w-[100vw]" : ""}`}>
            {/* ... other UI elements like header and online toggle ... */}
            <div className="overflow-y-scroll h-[calc(100vh-14rem)] w-full flex flex-col py-3">
                {filteredUsers.map((user) => (
                    <button
                        key={user._id}
                        onClick={() => setSelectedUser(user)} // Select user on click
                        className={`sm:w-full ... ${selectedUser?._id === user._id ? "bg-base-300 ring-1 ring-base-300" : ""}`}
                    >
                        <div className="relative mx-0">
                            <img src={user.profilePic || "/avatar.png"} alt={user.username} className="size-12 object-cover rounded-full" />
                            {/* Online indicator */}
                            {onlineUsers.includes(user._id) && (
                                <span className="absolute bottom-0 right-0 size-3 bg-green-500 rounded-full ring-2 ring-zinc-900" />
                            )}
                        </div>
                        <div className=" block text-left min-w-0">
                            <div className=" font-medium truncate">{user.username}</div>
                            <div className="text-sm text-zinc-400">
                                {onlineUsers.includes(user._id) ? "Online" : "Offline"}
                            </div>
                        </div>
                    </button>
                ))}
            </div>
            {filteredUsers.length == 0 && (
                <div className="text-center text-zinc-500 py-4">No online friends</div>
            )}
        </div>
    );
};

export default Sidebar;
```
[View on GitHub](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/Sidebar.jsx#L29-L87)

This code demonstrates fetching data with `useEffect`, filtering based on state, and rendering user profiles with real-time online status indicators.

## `ChatContainer.jsx` - The Core Chat Interface
The `ChatContainer` component is the central hub for messaging, responsible for displaying messages, handling real-time updates, and integrating the message input. It's dynamically rendered when a user is selected in the `Sidebar`.

### Purpose and Features
*   **Message Display**: Renders a list of messages between the authenticated user and the `selectedUser`.
*   **Real-time Updates**: Subscribes to and unsubscribes from WebSocket messages for live chat functionality.
*   **Auto-Scrolling**: Automatically scrolls to the latest message using `useRef`.
*   **Sender/Receiver Styling**: Differentiates messages sent by the authenticated user from those received, applying distinct chat bubble styles.
*   **Image Attachments**: Displays attached images within chat bubbles.
*   **Loading State**: Shows a skeleton loader while messages are being fetched.

### Key Snippet: Message Fetching and Real-time Subscription
The `useEffect` hooks in `ChatContainer` manage the lifecycle of message fetching and real-time subscriptions, ensuring the chat view is always up-to-date.

```jsx
// frontend/src/components/ChatContainer.jsx
import { useEffect, useRef } from "react";
import { useChatStore } from "../store/useChatStore";
import { useAuthStore } from "../store/useAuthStore";
import ChatHeader from "./ChatHeader";
import MessageInput from "./MessageInput";
import MessageSkeleton from "./skeletons/MessageSkeleton";
import { formatMessageTime } from "../lib/utils";

const ChatContainer = () => {
    const { messages, getMessages, isMessagesLoading, selectedUser, subscribeToMessages, unsubscribeFromMessages } =
        useChatStore();
    const { authUser } = useAuthStore();
    const messageEndRef = useRef(null);

    // Effect for fetching messages and subscribing to real-time updates
    useEffect(() => {
        if (selectedUser?._id) { // Ensure a user is selected before fetching messages
            getMessages(selectedUser._id);
            subscribeToMessages();
        }

        // Cleanup function to unsubscribe from messages when component unmounts or selectedUser changes
        return () => unsubscribeFromMessages();
    }, [selectedUser._id, getMessages, subscribeToMessages, unsubscribeFromMessages]); // Dependencies

    // Effect for auto-scrolling to the latest message
    useEffect(() => {
        if(messageEndRef.current && messages){
            messageEndRef.current.scrollIntoView({ behavior : "smooth" });
        }
    }, [messages]); // Trigger scroll when messages array updates

    if (isMessagesLoading) {
        return (
            <div className="flex-1 flex flex-col overflow-auto">
                <ChatHeader />
                <MessageSkeleton /> {/* Display skeleton while messages load */}
                <MessageInput />
            </div>
        );
    }
    // ... rendering messages ...
};

export default ChatContainer;
```
[View on GitHub](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/ChatContainer.jsx#L9-L37)

This snippet highlights the use of `useEffect` for data fetching and WebSocket subscription, along with `useRef` for UI interactions like auto-scrolling.

### Chat Message Rendering
Messages are rendered with conditional styling to indicate sender and recipient, and support for image attachments.

```jsx
// frontend/src/components/ChatContainer.jsx
// ... (inside ChatContainer return statement)
            <div className="flex-1 overflow-y-auto p-4 space-y-4">
                {messages.map((message) => (
                    <div
                        key={message._id}
                        // Apply chat-end for sender, chat-start for receiver
                        className={`chat ${message.senderId == authUser._id ? "chat-end": "chat-start"} `}
                        ref={messageEndRef} // Attach ref to the last message for scrolling
                    >
                        <div className="chat-image avatar">
                            <div className="size-9 rounded-full border">
                                <img
                                    src={message.senderId == authUser._id ? authUser.profilePic || "/avatar.png": selectedUser.profilePic || "/avatar.png"}
                                    alt="profilepic"
                                 />
                            </div>
                        </div>
                        <div className="chat-header mb-1">
                            <time className="text-xs opacity-50 ml-1">{formatMessageTime(message.createdAt)}</time>
                        </div>
                        <div className="chat-bubble flex flex-col">
                            {message.image && ( // Display image if present
                                <img
                                    src={message.image}
                                    alt="Attachment"
                                    className="sm:max-w-[200px] rounded-md "
                                />
                            )}
                            {message.text && <p>{message.text}</p>} {/* Display text if present */}
                        </div>
                    </div>
                ))}
            </div>
            <MessageInput />
        </div>
    );
};
```
[View on GitHub](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/ChatContainer.jsx#L42-L73)

This mapping function dynamically renders each message, showing profile pictures, timestamps, and message content (text or image) with appropriate styling based on the sender.

## `Navbar.jsx` - Top Navigation Bar
The `Navbar` component provides essential navigation and user-specific actions at the top of the application. It includes branding, quick access to friends, settings, user profile, and a logout mechanism.

### Purpose and Features
*   **Branding**: Displays the application logo and name (`ShinyChat`).
*   **Navigation Links**: Provides links to `/settings` and `/profile`.
*   **Friends Toggle**: A button to open/close the `FriendsBox` (likely a mobile-first feature).
*   **Authentication Actions**: Conditionally displays "Profile" and "Logout" buttons if a user is authenticated.
*   **Logout Functionality**: Triggers the `logout` action from `useAuthStore`.

### Key Snippet: Conditional Auth Links and Logout
The `Navbar` uses the `authUser` state from `useAuthStore` to conditionally render profile and logout options.

```jsx
// frontend/src/components/Navbar.jsx
import { Link } from "react-router-dom";
import { useAuthStore } from "../store/useAuthStore";
import { LogOut, MessageSquare, Settings, User, Users } from "lucide-react";
import { useChatStore } from "../store/useChatStore";

const Navbar = () => {
  const { logout, authUser } = useAuthStore();
  const { toggleFriendsBox } = useChatStore();

  return (
    <header
      className=" bg-base-100 border-b border-base-300 fixed w-full top-0 z-40
        backdrop-blur-lg bg-base-100/80"
    >
      <div className="container mx-auto px-4 h-16">
        <div className="flex items-center justify-between h-full">
          <div className="flex items-center gap-8">
            <Link to="/" className="flex items-center gap-2.5 hover:opacity-80 transition-all">
              <div className="size-9 rounded-lg bg-primary/10 flex items-center justify-center">
                <MessageSquare className="size-5 text-primary"></MessageSquare>
              </div>
              <h1 className="text-lg font-bold">ShinyChat</h1>
            </Link>
          </div>
          <div className="flex items-center gap-4">
            <button className="btn btn-sm gap-2" onClick={toggleFriendsBox}>
              <Users className="size-5" />
              <span className="hidden sm:inline">Friends</span>
            </button>
            <Link to={"/settings"} className={`btn btn-sm gap-2 transition-colors`}>
            <Settings className="size-4"/>
            <span className="hidden sm:inline">Settings</span>
            </Link>
            {/* Conditionally render Profile and Logout if authUser exists */}
            {authUser && (
              <>
                <Link to={"/profile"} className={`btn btn-sm gap-2`}>
                  <User className="size-5" />
                  <span className="hidden sm:inline">Profile</span>
                </Link>

                <button className="btn btn-sm flex gap-2 items-center" onClick={logout}>
                  <LogOut className="size-5" />
                  <span className="hidden sm:inline">Logout</span>
                </button>
              </>
            )}
          </div>
        </div>
      </div>
    </header>
  );
};

export default Navbar;
```
[View on GitHub](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/Navbar.jsx#L10-L58)

This snippet clearly shows how `authUser` determines the visibility of specific navigation items, enhancing the personalized user experience.

## Key Integration Points

### Application Flow - Initial Load to Chat
The interaction between `HomePage`, `Sidebar`, and `ChatContainer` defines the core user experience for messaging.





```mermaid
graph TD
    A["User navigates to App"] --> B["HomePage loads"]
    B --> C["Navbar (always visible)"]
    B --> D["Sidebar (displays friends)"]
    D --> E{("Is a user selected?")}
    E -- "No" --> F["NoChatSelected component"]
    E -- "Yes" --> G["ChatContainer (shows messages)"]
    G --> H["MessageInput (sends messages)"]
    D -- "User clicks friend" --> I["setSelectedUser (Zustand)"]
    I --> G;
    G --> J["Real-time messages from Backend"]
```



### Component-State Management Interactions
The components heavily rely on Zustand stores for managing global state, enabling a reactive and efficient UI.





```mermaid
flowchart LR
    subgraph Frontend Components
        A["Navbar.jsx"]
        B["Sidebar.jsx"]
        C["ChatContainer.jsx"]
        D["HomePage.jsx"]
    end

    subgraph Zustand Stores
        S1["useAuthStore (authUser, onlineUsers, logout)"]
        S2["useChatStore (selectedUser, messages, getMessages, subscribe, toggleFriendsBox)"]
    end

    A -->|Accesses "authUser, logout"| S1
    A -->|Accesses "toggleFriendsBox"| S2
    B -->|Accesses "getFriends, users, selectedUser, setSelectedUser"| S2
    B -->|Accesses "onlineUsers"| S1
    C -->|Accesses "messages, getMessages, selectedUser, subscribe, unsubscribe"| S2
    C -->|Accesses "authUser"| S1
    D -->|Accesses "selectedUser, isFriendsBoxOpen"| S2
    D -->|Renders B, C, F["NoChatSelected"]| B
    D -->|Renders C, F| C

```



### Best Practices & Insights
*   **Centralized State Management**: The use of Zustand (`useAuthStore`, `useChatStore`) provides a clear, centralized way to manage application state across various components, reducing prop drilling and making state changes predictable.
*   **Modular Components**: Each component has a single, well-defined responsibility (e.g., `Sidebar` for user listing, `ChatContainer` for message display), promoting reusability and maintainability.
*   **Lifecycle Management**: `useEffect` hooks are critical for handling side effects like data fetching, real-time subscriptions, and UI manipulations (e.g., auto-scrolling), ensuring resources are properly managed during component lifecycles.
*   **Responsive Design**: Conditional rendering and flexible layouts (e.g., `Sidebar` hiding on small screens when a user is selected) contribute to a better user experience across different device sizes.

---
Next: [State Management and Utilities](./3.2_state-management-and-utilities.mdx)
```