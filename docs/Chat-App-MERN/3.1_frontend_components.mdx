---
title: "Frontend Components"
description: "Documentation of the reusable UI components."
---

# Frontend Components

<TOC />

This document details the reusable UI components used in the frontend of the chat application.  We'll explore their functionality, structure, and how they interact with each other and the application's state management.

## ChatContainer Component

The `ChatContainer` component [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/ChatContainer.jsx) is the central display area for chat messages. It fetches, displays, and updates messages based on the currently selected user.

### Functionality

* **Message Fetching and Display:**  Fetches messages from the backend using `getMessages` from the `useChatStore` hook, based on the selected user's ID.  It then renders these messages to the screen.  Messages are displayed chronologically, with image attachments shown along with text. The sender's profile picture is also displayed.
* **Real-time Updates:** Uses `subscribeToMessages` and `unsubscribeFromMessages` to subscribe to real-time message updates.  This ensures the chat UI updates automatically when new messages arrive.  The `useEffect` hook manages the subscriptions lifecycle.
* **Automatic Scrolling:** The `messageEndRef` useRef is used to automatically scroll the chat to the bottom to show the newest message.
* **Loading State:**  Displays a loading skeleton (`MessageSkeleton`) while messages are being fetched.

### Structure and Implementation

The component's structure is straightforward: a header (`ChatHeader`), a scrollable message area, and a message input (`MessageInput`) at the bottom.  The use of `useEffect` hooks manages the fetching of messages, subscriptions, and scrolling behavior.

```jsx
useEffect(() => {
    getMessages(selectedUser._id);
    subscribeToMessages();
    return () => unsubscribeFromMessages();
}, [selectedUser._id, getMessages, subscribeToMessages, unsubscribeFromMessages]);

useEffect(() => {
    if (messageEndRef.current && messages) {
        messageEndRef.current.scrollIntoView({ behavior: "smooth" });
    }
}, [messages]);
```

The first `useEffect` hook ensures that messages are fetched and subscriptions are handled whenever the selected user changes. The second effect ensures that the view scrolls to the bottom as new messages are added. The conditional check prevents errors if `messageEndRef.current` is null before a message is rendered.

The message rendering logic uses the `map` function to iterate over the `messages` array and render each message with appropriate styling to indicate sender (either `chat-start` or `chat-end`).

```jsx
{messages.map((message) => (
    <div
        key={message._id}
        className={`chat ${message.senderId == authUser._id ? "chat-end" : "chat-start"}`}
        ref={messageEndRef}
    >
        {/* ... message rendering logic ... */}
    </div>
))}
```

### Component Interactions

`ChatContainer` interacts with `useChatStore` to manage the state of messages, the selected user and also the `MessageInput` component allowing users to send new messages.  The  `useAuthStore` hook provides the authenticated user's information for display purposes.


## MessageInput Component

The `MessageInput` component [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/MessageInput.jsx) allows users to send text and image messages.

### Functionality

* **Text Input:**  Provides a text input field for typing messages.
* **Image Upload:** Allows users to select and upload images, which are previewed before sending.
* **Message Sending:** Sends messages to the backend using `sendMessage` from `useChatStore`.
* **Error Handling:** Displays an error message if the user tries to upload a non-image file.

### Structure and Implementation

The component uses `useState` to manage the message text and image preview.  A hidden file input is used for image selection, and the `handleImageChange` function previews the selected image using a FileReader.  The `handleSendMessage` function sends the message data to the backend.

```jsx
const handleSendMessage = async (e) => {
    e.preventDefault();
    if (!text.trim() && !imagePreview) return;
    try {
        await sendMessage({ text: text.trim(), image: imagePreview });
        setText("");
        setImagePreview(null);
        // ...reset file input...
    } catch (error) {
        console.error("Failed to send message", error);
    }
};
```

This snippet showcases the asynchronous nature of sending messages using `sendMessage`. Error handling is implemented using a `try...catch` block.


### Component Interactions

`MessageInput` interacts with the `useChatStore` to send messages using the `sendMessage` function.

## Sidebar Component

The `Sidebar` component [Source](https://github.com/shinymack/Chat-App-MERN/blob/main/frontend/src/components/Sidebar.jsx) displays a list of the user's friends, allowing them to select a chat partner.

### Functionality

* **Friend Listing:** Fetches and displays a list of the user's friends from the backend using `getFriends` from `useChatStore`.
* **Online Status:** Indicates the online status of each friend using information from `onlineUsers` in `useAuthStore`.
* **Online Filter:** Allows users to filter the friend list to show only online users.
* **User Selection:** Allows the user to select a friend to chat with, updating the `selectedUser` state in `useChatStore`.

### Structure and Implementation

The component uses `useEffect` to fetch friends when it mounts.  The friend list is rendered using the `map` function, and each friend's online status is displayed.  A checkbox allows users to filter the list to only show online friends.

```jsx
useEffect(() => {
    getFriends();
}, [getFriends]);

const filteredUsers = showOnlineOnly
    ? users.filter((user) => onlineUsers.includes(user._id))
    : users;
```

This code shows how the component filters the users based on the `showOnlineOnly` state.

### Component Interactions

`Sidebar` interacts with `useChatStore` to fetch friends, update the selected user, and also interacts with `useAuthStore` to determine the online status of users.



## Component Hierarchy

````mermaid
graph TD
    A[App] --> B(ChatContainer);
    A --> C(Sidebar);
    B --> D{MessageInput};
    B --> E(ChatHeader);
    B --> F(MessageSkeleton);
```

## Next: [Frontend State Management](./3.2_frontend_state.mdx)